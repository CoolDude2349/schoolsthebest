<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load It</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden; 
        }
    </style>
</head>
<body>

    <script>
        const rawGitHubURL = "/schoolsthebest/g/eag1_9_4.html"; 

        // Function to check if service worker is enabled
        function isServiceWorkerEnabled() {
            return 'serviceWorker' in navigator && navigator.serviceWorker.controller;
        }

       
        function cacheHTMLWithJS(key, htmlContent) {
            if (typeof(Storage) !== "undefined") {
                localStorage.setItem(key, htmlContent);
                console.log("HTML with JavaScript cached!")
            } else {
                console.log("localStorage is not supported.")
            }
        }

    
        function openCachedHTML() {
            const cachedHTML = localStorage.getItem('offlinePageWithJS');
            if (cachedHTML) {
                const doc = document;
                if (doc) {
                    doc.open();
                    doc.write(cachedHTML);
                    doc.close();
                } else {
                    alert("Popup blocked! Please allow popups for this site.");
                }
            } else {
                alert("No cached HTML found.");
            }
        }

      
        function handleFetchedHTML(html) {
            const doc = document
            doc.open();
            doc.write(html);  
            doc.close();

            cacheHTMLWithJS('offlinePageWithJS', html); 
       
        }

      
        fetch(rawGitHubURL)
            .then(response => response.text())
            .then(html => {
                handleFetchedHTML(html); 
            })
            .catch(error => console.error("Error loading HTML:", error));

       
        window.onload = function() {
            if (!navigator.onLine && !isServiceWorkerEnabled() && localStorage.getItem('offlinePageWithJS')) {
                document.body.innerHTML = ""; 
                openCachedHTML(); 
            } else {
                console.log("Online, service worker is enabled, or no cached HTML available.");
            }
        }
    </script>

</body>
</html>
